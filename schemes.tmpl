" Name: {{.Name}} Colorscheme
" Author: robertmeta (on Github)
" URL: https://github.com/robertmeta/nofrils
" (see this url for latest release & screenshots)
" License: OSI approved MIT license

{{define "condAssign"}}{{if .val}} {{.attr}}={{.val}}{{end}}{{end}}
{{define "textStyle"}}{{/*
	*/}}{{template "condAssign" assignAttr .Attr        "term"}}{{/*
	*/}}{{template "condAssign" assignAttr .Attr        "cterm"}}{{/*
	*/}}{{template "condAssign" assignStr  .FG.TermCode "ctermfg"}}{{/*
	*/}}{{template "condAssign" assignStr  .BG.TermCode "ctermbg"}}{{/*
	*/}}{{template "condAssign" assignAttr .Attr        "gui"}}{{/*
	*/}}{{template "condAssign" assignStr  .FG.GuiCode  "guifg"}}{{/*
	*/}}{{template "condAssign" assignStr  .BG.GuiCode  "guibg"}}{{/*
*/}}{{end}}

hi clear
if exists("syntax_on")
    syntax reset
endif

let g:colors_name = "{{.Slug}}"

if !exists("g:nofrils_strbackgrounds")
    let g:nofrils_strbackgrounds = 0
endif
if !exists("g:nofrils_heavycomments")
    let g:nofrils_heavycomments = 0
endif
if !exists("g:nofrils_heavylinenumbers")
    let g:nofrils_heavylinenumbers = 0
endif

set background={{.Background}}

{{range .Groups}}
" {{.Name}}{{range .Rows}}
hi {{.Name}}{{template "textStyle" .}}{{end}}
{{end}}

" Helper Functions
function! NofrilsFocusComments()
    hi Comment{{template "textStyle" .NormalRow}}
    hi Normal{{template "textStyle" .FadedRow}}
    hi LineNr{{template "textStyle" .LineNrRow}}
    hi Character{{template "textStyle" .NoneRow}}
    hi String{{template "textStyle" .NoneRow}}

    if g:nofrils_heavycomments
        hi Comment{{template "textStyle" .HeavyCommentRow}}
    end
endfunction

function! NofrilsFocusCode()
    hi Comment{{template "textStyle" .FadedRow}}
    hi Normal{{template "textStyle" .NormalRow}}
    hi LineNr{{template "textStyle" .LineNrRow}}
    hi Character{{template "textStyle" .NoneRow}}
    hi String{{template "textStyle" .NoneRow}}

    if g:nofrils_strbackgrounds
        hi Character{{template "textStyle" .HeavyStringRow}}
        hi String{{template "textStyle" .HeavyStringRow}}
    end
endfunction

function! NofrilsNormal()
    hi Comment{{template "textStyle" .FadedRow}}
    hi Normal{{template "textStyle" .NormalRow}}
    hi LineNr{{template "textStyle" .LineNrRow}}
    hi Character{{template "textStyle" .NoneRow}}
    hi String{{template "textStyle" .NoneRow}}

    " Optional Syntax Features
    if g:nofrils_strbackgrounds
        hi Character{{template "textStyle" .HeavyStringRow}}
        hi String{{template "textStyle" .HeavyStringRow}}
    end
    if g:nofrils_heavycomments
        hi Comment{{template "textStyle" .HeavyCommentRow}}
    end
    if g:nofrils_heavylinenumbers
        hi LineNr{{template "textStyle" .HeavyLineRow}}
    end
endfunction

" Command mappings
command! NofrilsDark :colo nofrils-dark
command! NofrilsLight :colo nofrils-light
command! NofrilsSepia :colo nofrils-sepia
command! NofrilsAcme :colo nofrils-acme
command! NofrilsFocusNormal :call NofrilsNormal()
command! NofrilsFocusCode :call NofrilsFocusCode()
command! NofrilsFocusComments :call NofrilsFocusComments()

" Setup normal settings
call NofrilsNormal()
